<!DOCTYPE HTML>
<html>
    <head>

        <script src="./pivot/codebase/webix/webix.js" type="text/javascript"></script>
        <script src="./pivot/codebase/pivot.js" type="text/javascript"></script>

        <link rel="stylesheet" href="./pivot/codebase/webix/webix.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="./pivot/codebase/pivot.css" type="text/css" charset="utf-8">
        
    </head>
    <body>
        <h1> Dad is cool </h1>
        <div id="testA">
            <script type="text/javascript" charset="utf-8">
                function table(data) {
                    webix.ui({
                        id:"pivot",
                        view:"pivot",
                        data: data,
                        columnWidth: 150,
                        datatable:{
                            rowHeight:27,
                            rowLineHeight:27,
                            headerRowHeight:27,
                            scheme:{
                              $init:function(obj){
                                obj.name = obj.name + " (a)"
                              }
                            }
                        },
                        max: true,
                        structure: {
                            rows: ["Datacenter", "Name"],
                            columns: [],
                            values: [
                                {name: "Peak CPU (24 hours)", operation: "sum"},
                                {name: "Peak CPU (7 days)", operation: "sum"},
                                {name: "Peak CPU (30 days)", operation: "sum"},
                                {name: "Peak Memory (24 hours)", operation: "sum"}, 
                                {name: "Peak Memory (7 days)", operation: "sum"},
                                {name: "Peak Memory (30 days)", operation: "sum"},
                                {name: "Avg CPU (24 hours)", operation: "sum"},
                                {name: "Avg CPU (7 days)", operation: "sum"},
                                {name: "Avg CPU (30 days)", operation: "sum"},
                                {name: "Avg Memory (24 hours)", operation: "sum"},
                                {name: "Avg Memory (7 days)", operation: "sum"},
                                {name: "Avg Memory (30 days)", operation: "sum"}
                            ],
                        },
                        fieldMap: {

                        },
                    });
                }

                var url='http://localhost:9292/data';
                var Http = new XMLHttpRequest();
                Http.open("GET", url, true); 
                Http.send(); 

                Http.onreadystatechange = (e) => {
                    if (Http.readyState == 4) {
                        var head = JSON.parse(Http.response).column_headers;
                        var row_data = JSON.parse(Http.response).row_data;
                        var data = []
                        for (p = 0; p < row_data.length; p++) {
                            data.push({})
                            for (h = 0; h < head.length; h++) {
                              data[p][head[h]] = row_data[p][h];
                            }
                        }
                        table(data)
                    }
                }
            </script>
        </div>
    </body>
</html>
